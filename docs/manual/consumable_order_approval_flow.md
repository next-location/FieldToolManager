# 消耗品発注の承認フロー

**最終更新日**: 2026-01-21
**対象**: Staff、Leader、Manager、Admin（全権限）

---

## 目次

1. [承認フローの概要](#承認フローの概要)
2. [簡易発注フロー（消耗品発注）](#簡易発注フロー消耗品発注)
3. [正式な発注フロー（発注書作成）](#正式な発注フロー発注書作成)
4. [承認権限とルール](#承認権限とルール)
5. [運用パターン](#運用パターン)
6. [FAQ](#faq)

---

## 承認フローの概要

ザイロクでは、発注の重要度や金額に応じて**2つの発注方法**を用意しています。

### 発注方法の使い分け

| 発注方法 | 承認フロー | 適用対象 | 権限 | 記録 |
|---------|-----------|---------|------|------|
| **簡易発注**<br>（消耗品発注管理） | なし（即時発注可能） | 少額・日常消耗品 | Leader/Manager/Admin | 発注履歴のみ |
| **正式発注**<br>（発注書作成） | あり（承認・差戻し） | 高額・重要案件 | 申請者 + 承認者 | 発注書 + 承認履歴 |

### ワークフロー図

```
【簡易発注】
下書き中 → 発注済み → 納品済み
           ↓
        キャンセル

【正式発注】※発注書機能使用
下書き → 承認申請 → 承認 → 発注 → 納品 → 支払済み
                  ↓
                差戻し
```

---

## 簡易発注フロー（消耗品発注）

少額・日常的な消耗品の発注に使用します。**承認フローなし**で即座に発注できます。

### 対象となる発注

以下のような発注に適しています：

- **少額の消耗品**: ビス、釘、テープ、軍手など
- **定期購入品**: 毎月購入する消耗品
- **緊急性の高い発注**: 現場で急に必要になった消耗品
- **承認不要の発注**: 組織のルールで承認が不要な金額帯

### ステータスの流れ

#### 1. 下書き中（初期状態）

**発注登録時のデフォルト状態です。**

**できること**:
- 発注内容の編集
- 発注のキャンセル
- 「発注済み」に変更

**使用例**:
- 見積もり取得中
- 上司に口頭確認中
- 発注内容を検討中

**操作**:
```
消耗品発注管理 > 新規発注 > 内容入力 > 登録
↓
ステータス: 下書き中
```

#### 2. 発注済み（発注確定）

**仕入れ先に正式に発注した状態です。**

**変更方法**:
1. 発注詳細画面を開く
2. **「発注済みにする」** ボタンをクリック
3. 確認ダイアログで **「確定」** をクリック

**注意事項**:
- **仕入れ先に連絡してから変更**: システム上の変更だけでは仕入れ先に通知されません
- **編集可能**: 発注内容を後から修正できます（ただし仕入れ先に連絡必須）
- **キャンセル可能**: まだキャンセルできます

**操作**:
```
発注詳細画面 > 「発注済みにする」ボタン > 確認
↓
ステータス: 発注済み
```

#### 3. 納品済み（納品完了）

**仕入れ先から納品が完了した状態です。**

**変更方法**:
1. 発注詳細画面を開く
2. **「納品完了処理」** ボタンをクリック
3. 納品日を入力（デフォルト: 今日）
4. 納品メモを入力（任意）
5. **「納品完了」** をクリック

**自動処理**:
- ✅ 倉庫在庫が自動的に増加
- ✅ 実際の納品日を記録
- ✅ 受領者（処理したユーザー）を記録

**注意事項**:
- **編集不可**: 納品後は編集できません
- **取り消し不可**: 誤って納品完了した場合は在庫調整が必要

**操作**:
```
発注詳細画面 > 「納品完了処理」ボタン > 納品日入力 > 納品完了
↓
ステータス: 納品済み（自動的に倉庫在庫が増加）
```

#### 4. キャンセル（発注取り消し）

**発注がキャンセルされた状態です。**

**キャンセル可能なタイミング**:
- ✅ 下書き中
- ✅ 発注済み
- ❌ 納品済み（キャンセル不可）

**変更方法**:
1. 発注詳細画面を開く
2. **「発注をキャンセル」** ボタンをクリック
3. 確認ダイアログで **「キャンセル」** をクリック

**注意事項**:
- **取り消し不可**: キャンセル後は元に戻せません
- **在庫に影響なし**: 在庫数は変更されません
- **履歴として残る**: 発注一覧に灰色で表示されます

**操作**:
```
発注詳細画面 > 「発注をキャンセル」ボタン > 確認
↓
ステータス: キャンセル（履歴として残る）
```

### 簡易発注のメリット

| メリット | 説明 |
|---------|------|
| **迅速な発注** | 承認待ちなしで即座に発注可能 |
| **シンプルな操作** | 最小限の入力項目で登録完了 |
| **柔軟な運用** | 組織のルールに合わせて運用可能 |
| **記録の保持** | 発注履歴がすべて残る |

---

## 正式な発注フロー（発注書作成）

高額・重要な発注には、正式な発注書を作成して承認フローを経由します。

### 対象となる発注

以下のような発注に適しています：

- **高額の発注**: 10万円以上の発注など（組織のルールに応じて）
- **重要な資材**: プロジェクトの中核となる資材
- **複数品目の発注**: 明細が複数行にわたる発注
- **承認必須の発注**: 組織のルールで承認が必要な発注

### 簡易発注から正式発注への切り替え

**消耗品発注管理で登録した発注を、正式な発注書に変換できます。**

#### 変換手順

1. **消耗品発注詳細画面を開く**
   - ステータスが「下書き中」または「発注済み」であること

2. **「📄 正式な発注書を作成」ボタンをクリック**
   - 発注詳細画面の「アクション」セクションに表示

3. **発注書作成画面に移動**
   - 消耗品発注の情報が自動的に引き継がれる
   - 発注番号、消耗品名、数量、単価、仕入れ先など

4. **追加情報を入力**
   - 納品場所、支払条件、社内メモなど
   - 複数品目がある場合は明細を追加

5. **発注書を登録**
   - ステータス: 「下書き」として登録される

### 正式発注のステータスフロー

#### 1. 下書き（Draft）

**発注書作成者が内容を準備中の状態です。**

**できること**:
- 発注内容の編集
- 明細行の追加・削除
- 発注書の削除

**次のアクション**:
- 「承認申請」に進む

#### 2. 承認申請中（Submitted）

**承認者に承認を依頼中の状態です。**

**誰が確認するか**:
- Manager権限以上のユーザー
- 組織で指定された承認者

**承認者ができること**:
- 承認（Approved）に進める
- 差戻し（Rejected）して修正を依頼

**申請者ができること**:
- 承認待ち状態を確認
- 承認者に催促（システム外）

#### 3. 承認済み（Approved）

**承認者が承認した状態です。**

**記録される情報**:
- 承認者（approved_by）
- 承認日時（approved_at）
- 承認コメント

**次のアクション**:
- 「発注済み」に進む

#### 4. 差戻し（Rejected）

**承認者が修正を依頼した状態です。**

**記録される情報**:
- 差戻し者（rejected_by）
- 差戻し日時（rejected_at）
- 差戻し理由（rejection_reason）

**申請者ができること**:
- 発注内容を修正
- 再度「承認申請」に進む

**注意事項**:
- 差戻し理由を必ず確認
- 修正後は再申請が必要

#### 5. 発注済み（Ordered）

**仕入れ先に正式に発注した状態です。**

**実行条件**:
- 承認済み（Approved）であること

**変更方法**:
- 承認済みの発注書で「発注確定」ボタンをクリック

**記録される情報**:
- 発注日時（ordered_at）

#### 6. 納品済み（Received）

**仕入れ先から納品が完了した状態です。**

**自動処理**:
- 発注書に記載された品目の在庫が自動的に増加

**記録される情報**:
- 納品日時（delivered_at）

#### 7. 支払済み（Paid）

**仕入れ先への支払いが完了した状態です。**

**記録される情報**:
- 支払日時（paid_at）

**注意事項**:
- 支払記録（payment_records）と連携

### 正式発注のメリット

| メリット | 説明 |
|---------|------|
| **承認フロー** | 高額発注の承認プロセスを明確化 |
| **詳細な記録** | 承認履歴、差戻し理由をすべて記録 |
| **複数品目対応** | 明細行で複数品目を管理 |
| **支払管理** | 請求書・支払記録と連携 |

---

## 承認権限とルール

### 権限別の操作可能範囲

#### 簡易発注（消耗品発注）

| 権限 | 閲覧 | 登録 | 編集 | 発注確定 | 納品処理 | キャンセル |
|------|------|------|------|---------|---------|-----------|
| **Staff** | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ |
| **Leader** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| **Manager** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| **Admin** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

#### 正式発注（発注書）

| 権限 | 閲覧 | 作成 | 編集 | 承認申請 | 承認 | 差戻し | 発注確定 | 納品処理 |
|------|------|------|------|---------|------|--------|---------|---------|
| **Staff** | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| **Leader** | ✅ | ✅ | ✅※ | ✅ | ❌ | ❌ | ❌ | ❌ |
| **Manager** | ✅ | ✅ | ✅※ | ✅ | ✅ | ✅ | ✅ | ✅ |
| **Admin** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

※ 自分が作成した発注書のみ編集可能

### 承認ルールのカスタマイズ

組織の運用に合わせて、以下のルールを設定できます：

1. **金額による承認要否**
   - 例: 10万円以上は承認必須、未満は簡易発注可能

2. **品目による承認要否**
   - 例: 重要資材は承認必須、消耗品は簡易発注可能

3. **承認者の指定**
   - 例: Manager以上が承認、Leaderは申請のみ

4. **複数承認者**（将来実装予定）
   - 例: 50万円以上は2名の承認が必要

---

## 運用パターン

### パターン1: 少額消耗品の即時発注

**対象**: 10万円未満の消耗品

**フロー**:
```
1. Leaderが簡易発注で登録
2. 内容確認後「発注済み」に変更
3. 仕入れ先に発注（電話・メール）
4. 納品されたら「納品完了処理」
```

**メリット**: 迅速な発注、承認待ちなし

### パターン2: 高額資材の承認付き発注

**対象**: 10万円以上の資材

**フロー**:
```
1. Leaderが簡易発注で登録（下書き中）
2. 「正式な発注書を作成」をクリック
3. 発注書を作成し「承認申請」
4. Managerが内容を確認し「承認」
5. 承認後、仕入れ先に発注（電話・メール）
6. 発注書を「発注済み」に変更
7. 納品されたら「納品完了処理」
```

**メリット**: 承認履歴が残る、金額管理が厳格

### パターン3: 緊急発注（事後承認）

**対象**: 現場で急に必要になった消耗品

**フロー**:
```
1. Leaderが簡易発注で登録
2. 即座に「発注済み」に変更
3. 仕入れ先に緊急発注（電話）
4. 上司に口頭で事後報告
5. 納品されたら「納品完了処理」
```

**メリット**: 緊急時に柔軟対応、後から履歴確認可能

### パターン4: 定期購入品の簡易運用

**対象**: 毎月定期的に購入する消耗品

**フロー**:
```
1. Leaderが簡易発注で登録（月初）
2. 「発注済み」に変更
3. 仕入れ先に発注（いつもの取引先）
4. 納品されたら「納品完了処理」
```

**メリット**: 定型業務の効率化

---

## FAQ

### Q1. 簡易発注と正式発注の違いは何ですか？

**A.** 簡易発注（消耗品発注管理）は承認フローなしで即座に発注でき、少額・日常消耗品に適しています。正式発注（発注書作成）は承認フローがあり、高額・重要案件に適しています。

### Q2. どのタイミングで正式発注に切り替えるべきですか？

**A.** 以下の場合は正式発注を推奨します：
- 発注金額が高額（例: 10万円以上）
- 承認が必要な発注
- 複数品目を一括発注
- 詳細な記録が必要な発注

組織のルールに合わせて判断してください。

### Q3. 簡易発注で登録した後、正式発注に変換できますか？

**A.** はい、できます。発注詳細画面の「📄 正式な発注書を作成」ボタンをクリックすると、発注書作成画面に移動し、情報が自動的に引き継がれます。

### Q4. 承認者が不在の場合、発注を進められますか？

**A.** 正式発注の場合、承認者の承認が必要です。承認者が不在の場合は以下の対応があります：
- 別の承認権限者（Manager/Admin）に依頼
- 緊急の場合は簡易発注で対応し、事後報告
- 承認者の代理権限を設定（将来実装予定）

### Q5. 承認が差し戻された場合、どうすればよいですか？

**A.** 差戻し理由を確認し、発注内容を修正してから再度「承認申請」を行ってください。差戻し理由は発注書詳細画面の履歴で確認できます。

### Q6. 発注確定後、内容を変更したい場合はどうすればよいですか？

**A.** 以下の対応方法があります：

**簡易発注の場合**:
- 「発注済み」状態でも編集可能
- 仕入れ先に変更を連絡してから編集

**正式発注の場合**:
- 「発注済み」後は編集できません
- 発注をキャンセルし、新規で作成し直す
- または、仕入れ先と直接調整し、メモに記録

### Q7. 納品完了処理を誤って実行した場合、取り消せますか？

**A.** いいえ、納品完了処理は取り消せません。誤って納品完了した場合は以下の対応が必要です：
1. 管理者に連絡
2. 在庫調整機能で在庫数を修正
3. メモに修正内容を記録

予防策として、納品完了前に発注内容を必ず確認してください。

### Q8. 承認履歴はどこで確認できますか？

**A.** 正式発注（発注書）の場合、発注書詳細画面の「履歴」タブで以下の情報を確認できます：
- 承認者・承認日時
- 差戻し者・差戻し理由
- ステータス変更履歴
- コメント

簡易発注の場合は、承認履歴は記録されません（承認フローがないため）。

### Q9. 発注の権限はどこで確認できますか？

**A.** ユーザーの権限は、画面右上のユーザーメニューで確認できます。権限変更が必要な場合は、Adminに連絡してください。

### Q10. 複数の消耗品をまとめて発注できますか？

**A.** 簡易発注では1品目ずつ発注します。複数品目をまとめて発注する場合は、正式発注（発注書作成）を使用してください。発注書では明細行を複数追加できます。

---

## 関連マニュアル

- [消耗品発注管理マニュアル](./consumable_orders.md) - 基本的な発注操作
- [発注書管理マニュアル](./purchase_orders.md)（将来追加予定） - 正式な発注書の作成・管理
- [消耗品管理マニュアル](./consumable_management.md) - 消耗品の登録と在庫管理
- [取引先管理マニュアル](./clients.md) - 仕入れ先の登録と管理

---

**承認フローを適切に使い分けて、効率的な発注管理を実現しましょう！**
