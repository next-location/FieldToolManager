# 作業報告書承認マニュアル

## 1. 概要

スタッフが提出した作業報告書を承認または却下する機能です。リーダーと管理者が承認権限を持ち、報告内容を確認した上で承認・却下の判断を行います。

**主な機能**:
- 承認待ち報告書の一覧表示
- 個別承認・却下（コメント付き）
- 一括承認機能
- 一括PDF出力
- 承認履歴の記録

---

## 2. 対象者

| 権限レベル | 承認・却下 | 承認待ち閲覧 |
|------------|------------|--------------|
| 一般スタッフ | ❌ | ❌ |
| リーダー | ✅ | ✅ |
| マネージャー | ❌ | ❌ |
| 管理者 | ✅ | ✅ |

リーダーと管理者のみが作業報告書を承認・却下できます。

---

## 3. アクセス方法

1. 左サイドメニューから **「作業報告書」** をクリック
2. サブメニューから **「承認待ち」** をクリック
3. 承認待ち作業報告書一覧が表示されます

**URL**: `/work-reports/pending`

---

## 4. 承認待ち一覧画面

### 4-1. 表示内容

承認待ち（status: submitted）の作業報告書が新しい順に表示されます。

**各報告書の表示情報**:
- 報告日
- 現場名
- 作成者名
- 作業員数
- 作業内容（抜粋）

### 4-2. 報告書の確認

報告書の日付または現場名をクリックすると、詳細画面が開きます。

**詳細画面で確認できる情報**:
- 報告日、現場、天候、気温
- 作業内容（詳細）
- 作業員一覧（作業時間付き）
- 使用した道具・重機
- 添付写真・資料
- 安全確認事項
- 特記事項

---

## 5. 個別承認・却下の手順

### 5-1. 承認の手順

1. 承認待ち一覧で対象の報告書を確認
2. 必要に応じて詳細画面を開いて内容を確認
3. **「承認」** ボタン（緑色）をクリック
4. コメント入力モーダルが表示されます
5. コメントを入力（任意）
6. **「承認する」** ボタンをクリック
7. 承認が完了し、報告書のステータスが「承認済み（approved）」になります

**承認コメントの例**:
```
✅ 内容確認しました。承認します。
✅ 問題ありません。お疲れ様でした。
✅ 作業報告ありがとうございます。
```

### 5-2. 却下の手順

1. 承認待ち一覧で対象の報告書を確認
2. 詳細画面を開いて問題点を確認
3. **「却下」** ボタン（赤色）をクリック
4. コメント入力モーダルが表示されます
5. 却下理由をコメントに入力（推奨）
6. **「却下する」** ボタンをクリック
7. 却下が完了し、報告書のステータスが「却下（rejected）」になります

**却下コメントの例**:
```
❌ 作業時間が記入されていません。修正して再提出してください。
❌ 添付写真が不足しています。作業箇所の写真を追加してください。
❌ 使用した重機が記載されていません。詳細を追加してください。
❌ 作業内容が不明瞭です。具体的に記入して再提出してください。
```

### 5-3. コメントの入力

**コメントは任意**ですが、以下の場合は入力を推奨します：

- **承認時**: 良かった点、改善点、感謝の言葉など
- **却下時**: 却下理由、修正すべき点、再提出時の注意事項（強く推奨）

**コメントのメリット**:
- 作成者へのフィードバックになる
- 承認・却下の理由が明確になる
- 承認履歴として記録される

---

## 6. 一括承認機能

複数の報告書をまとめて承認できます。

### 6-1. 一括承認の手順

1. 承認待ち一覧で、承認したい報告書の左側のチェックボックスにチェックを入れます
2. 複数選択する場合は、各報告書のチェックボックスをクリック
3. または **「全選択」** をクリックしてすべて選択
4. 画面右上の **「一括承認」** ボタン（緑色）をクリック
5. 一括承認確認モーダルが表示されます
6. 選択件数を確認
7. コメントを入力（任意、全報告書に共通適用）
8. **「一括承認する」** ボタンをクリック
9. 選択したすべての報告書が一度に承認されます

**一括承認のコメント例**:
```
✅ 本日提出分まとめて承認しました。お疲れ様でした。
✅ 内容確認しました。問題ありません。
✅ 今週分の報告書を承認します。
```

### 6-2. 一括承認の注意点

- **すべての報告書に同じコメントが適用**されます
- 承認後は個別に取り消すことができません
- 内容に問題がある報告書が含まれていないか、事前に確認してください

### 6-3. 一括承認の使用例

**推奨される使用シーン**:
- 定型的な作業報告書を一度にまとめて承認
- 信頼できるスタッフからの報告書を定期的に承認
- 月末の報告書締め処理

**避けるべき使用シーン**:
- 内容を詳しく確認していない報告書
- 問題がある可能性のある報告書
- 初めて報告書を提出するスタッフの報告書

---

## 7. 一括PDF出力機能

複数の報告書をまとめてPDF出力できます。

### 7-1. 一括PDF出力の手順

1. 承認待ち一覧で、PDF出力したい報告書のチェックボックスにチェックを入れます
2. 画面右上の **「一括PDF出力」** ボタン（青色）をクリック
3. 選択したすべての報告書が個別にPDFとしてダウンロードされます
4. ブラウザのダウンロードフォルダに保存されます

**ファイル名の例**:
```
作業報告書_2026-01-15_A現場_山田太郎.pdf
作業報告書_2026-01-16_B現場_佐藤次郎.pdf
作業報告書_2026-01-17_C現場_鈴木三郎.pdf
```

### 7-2. 一括PDF出力の活用例

- **月次報告**: 月末に1ヶ月分の報告書をまとめてPDF出力
- **取引先提出**: 取引先に提出する報告書をまとめて出力
- **保管・アーカイブ**: 承認済み報告書を紙またはデジタルで保管
- **経営会議**: 役員会議用の資料として出力

---

## 8. 承認履歴

承認・却下された報告書には、承認履歴が記録されます。

### 8-1. 承認履歴の表示

報告書詳細画面で、ステータスが「承認済み」または「却下」の場合、画面下部に **「承認履歴」** セクションが表示されます。

**承認履歴に記録される情報**:
- 承認者名
- 承認・却下の別
- コメント
- 承認日時

### 8-2. 承認履歴の確認例

```
【承認履歴】

✅ 承認  山田リーダー  2026-01-15 17:30
   コメント: 内容確認しました。承認します。お疲れ様でした。
```

```
【承認履歴】

❌ 却下  山田リーダー  2026-01-15 17:25
   コメント: 作業時間が記入されていません。修正して再提出してください。

✅ 承認  山田リーダー  2026-01-15 19:10
   コメント: 修正内容確認しました。承認します。
```

---

## 9. 報告書のステータス遷移

作業報告書は以下のステータスを持ちます：

| ステータス | 説明 | 次のアクション |
|-----------|------|----------------|
| **下書き（draft）** | 作成中、未提出 | スタッフが提出 |
| **提出済み（submitted）** | 承認待ち | リーダー・管理者が承認または却下 |
| **承認済み（approved）** | 承認完了 | なし（確定） |
| **却下（rejected）** | 却下済み | スタッフが修正して再提出 |

### 9-1. ステータス遷移図

```
下書き（draft）
    ↓ [スタッフが提出]
提出済み（submitted）
    ↓ [リーダー・管理者が判断]
    ├→ 承認済み（approved）← 確定
    └→ 却下（rejected）
           ↓ [スタッフが修正・再提出]
        提出済み（submitted）
```

### 9-2. 再提出の流れ

1. リーダー・管理者が報告書を却下（コメントで修正点を指示）
2. 作成者に却下通知が届く
3. 作成者が報告書を修正
4. 作成者が再度提出
5. リーダー・管理者が再度承認・却下を判断

---

## 10. 通知機能

承認・却下を行うと、作成者に自動的に通知が送信されます。

### 10-1. 承認時の通知

**通知内容**:
```
【作業報告書承認】
あなたが提出した作業報告書（2026-01-15 A現場）が承認されました。

承認者: 山田リーダー
コメント: 内容確認しました。承認します。お疲れ様でした。
```

### 10-2. 却下時の通知

**通知内容**:
```
【作業報告書却下】
あなたが提出した作業報告書（2026-01-15 A現場）が却下されました。

承認者: 山田リーダー
コメント: 作業時間が記入されていません。修正して再提出してください。
```

---

## 11. 注意事項とベストプラクティス

### 11-1. 注意事項

1. **承認・却下は取り消せません**: 誤って承認・却下した場合、作成者に連絡して再提出を依頼してください
2. **コメントは作成者に表示されます**: 丁寧で建設的なフィードバックを心がけてください
3. **一括承認は慎重に**: 内容を確認せずに一括承認すると、問題のある報告書が承認される可能性があります
4. **却下理由は明確に**: 却下する場合は、具体的な修正点をコメントに記入してください

### 11-2. ベストプラクティス

#### 承認時のベストプラクティス

1. **迅速な承認**: 提出から24時間以内の承認を目指す
2. **ポジティブなフィードバック**: 良かった点を褒める
3. **改善提案**: 次回への改善点があれば優しく伝える
4. **定期的な確認**: 毎日または週2回、承認待ち一覧をチェック

#### 却下時のベストプラクティス

1. **具体的な指摘**: 「作業時間が記入されていません」など、何が不足しているか明確に伝える
2. **修正方法の提示**: 「作業箇所の写真を3枚以上添付してください」など、具体的な修正方法を提示
3. **励ましの言葉**: 「修正後に再提出してください。よろしくお願いします。」など、前向きな言葉を添える
4. **スタッフへの連絡**: 却下後、直接スタッフに連絡して修正点を伝える

#### 一括承認時のベストプラクティス

1. **事前の個別確認**: 各報告書の内容を事前に確認
2. **定型報告に限定**: 定型的な作業報告書のみ一括承認
3. **適切なコメント**: 「本日提出分承認」など、一括承認であることが分かるコメント
4. **週次・月次処理**: 週末や月末にまとめて一括承認

---

## 12. トラブルシューティング

| 問題 | 原因 | 解決方法 |
|------|------|----------|
| 承認ボタンが表示されない | 権限不足 | リーダーまたは管理者でログインしてください |
| 承認・却下ができない | 報告書が既に承認または却下済み | 報告書のステータスを確認してください |
| 一括承認に失敗する | 一部の報告書が承認できない状態 | エラーメッセージを確認し、個別に承認してください |
| 承認したのに承認待ちに残っている | ページが更新されていない | ページをリロードしてください |
| コメントが保存されない | 通信エラー | ネット接続を確認し、再度実行してください |

---

## 13. よくある使用例

### 13-1. 日次承認（毎日の運用）

```
【朝の承認作業】
1. 前日提出分の報告書を確認
2. 問題がなければ一括承認
3. 問題がある報告書は個別に却下（修正点をコメント）

【夕方の承認作業】
1. 当日提出分の報告書を確認
2. 緊急案件は個別に承認
3. 定型報告は翌朝まとめて承認
```

### 13-2. 週次承認（週末の運用）

```
【金曜日の承認作業】
1. 今週提出分の報告書をすべて確認
2. 全選択で一括承認
3. 一括PDF出力して週報として保存
4. 月曜日の朝礼で報告
```

### 13-3. 月次承認（月末の運用）

```
【月末の承認作業】
1. 今月提出分の報告書を最終確認
2. 未承認の報告書を個別に承認
3. 全報告書を一括PDF出力
4. 経営会議資料として役員に提出
```

---

## 14. 関連ドキュメント

- [作業報告書作成マニュアル](./work_reports_create.md)（作成予定）
- [作業報告書PDF出力マニュアル](./work_reports_pdf.md)（作成予定）
- [作業報告書設定マニュアル](./work_reports_settings.md)（作成予定）

---

**最終更新**: 2026-01-21
